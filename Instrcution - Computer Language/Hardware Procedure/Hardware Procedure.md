-----
### 하드웨어의 프로시저 지원
-----
1. 프로시저(Procedure)나 함수는 이해하기 쉽게 재사용이 가능하도록 프로그램을 구조화하는 방법 중 하나
   - 프로시저 : 제공되는 인수에 따라서 특정 작업을 수행하는 서브루틴
   - 즉, 프로시저는 프로그래머가 한 번에 한 부분씩 집중해서 처리할 수 있게 해줌
   - 인수(Parameter) : 프로시저에 값을 보내고 결과를 받아오는 일을 하므로, 프로그램의 다른 부분과 데이터 프로시저 사이의 인터페이스 역할을 함
   - 프로시저는 소프트웨어에서 추상화를 구현하는 방법 중 하나
  
2. 프로그램이 프로시저를 실행할 때, 여섯 단계를 거침
   - 프로시저가 접근할 수 있는 곳에 인수를 넣음
   - 프로시저로 제어를 넘김
   - 프로시저가 필요로 하는 메모리 자원을 획득
   - 필요한 작업을 수행
   - 호출한 프로그램이 접근할 수 있는 장소에 결과값을 넣음
   - 프로시저는 프로그램 내 여러 곳에서 호출될 수 있으므로, 원래 위치로 제어를 돌려줌

3. 레지스터는 데이터를 저장하는 가장 빠른 장소이므로, 가능한 한 많이 사용하는 것이 바람직
   - MIPS 소프트웨어는 다음 프로시저 호출 관례에 따라 레지스터 할당
     + $a0 ~ $a3 : 전달할 인수를 가지고 있는 인수 레지스터 4개
     + $v0 ~ $v1 : 반환되는 값을 갖게 되는 값 레지스터 2개
     + $ra : 호출한 곳으로 되돌아가기 위한 복귀 주소를 가지고 있는 레지스터 1개
   - MIPS 어셈블리 언어는 레지스터를 할당할 뿐 아니라 프로시저를 위한 명령어도 제공
     + jal(jump-and-link) 명령어는 지정된 주소로 점프하면서 동시에 다음 명령어 주소를 $ra 레지스터에 저장하며 모양은 다음과 같음
     + jal : 지정된 주소로 점프하면서 동시에 다음 명령어 주소를 레지스터(MIPS에서 $ra)에 저장하는 명령어
```
jal ProcedureAddress
```
   - jump-and-link에서 link는 프로시저 종료 후 올바른 주소로 되돌아올 수 있도록 호출한 곳과 프로시저 사이에 주소 또는 링크를 형성한다는 뜻
   - 레지스터 $ra(31번 레지스터)에 기억되는 이 링크를 복귀 주소(Return Address)라 고부름
     + 복귀 주소 : 프로시저 종료 후 제자리에 돌아갈 수 있게 호출 위치에 대한 링크, MIPS에서는 $ra에 저장
   - 한 프로시저가 여러 곳에서 호출될 수 있으므로 복귀 주소는 꼭 필요

4. MIPS는 프로시저에 복귀할 때 case 문 구현에 사용했던 jr(jump register) 명령을 이용
   - jr은 레지스터에 저장된 주소로 무조건 점프하라는 명령어
```
jr $ra
```
   - 위 명령어는 레지스터 $ra에 저장되어 있는 주소로 점프하라는 뜻
   - 호출 프로그램(Caller)은 $a0 ~ $a3에 전달할 인수값을 넣은 후 jal X 명령을 이용해 프로시저 X[피호출 프로그램(Callee)라고 부름]로 점프
     + 호출 프로그램 : 프로시저 실행을 시작시키고, 필요한 인수값을 제공하는 프로그램
     + 피호출 프로그램 : 호출 프로그램이 제공하는 인수값을 이용해서 일련의 명령어를 실행한 후, 호출 프로그램으로 제어를 넘기는 프로그램
   - 피호출 프로그램은 계산을 끝낸 후 계산 결과를 $v0 ~ $v1에 넣은 후 jr $ra 명령을 실행하여 복귀

5. 내장 프로그램 개념은 현재 실행 중인 명령어의 주소를 기억하는 레지스터를 필요로 함
   - 이 레지스터의 이름은 명령어 주소 레지스터(Instruction Address Register)라고 하는 거의 타당하겠지만, 역사적인 이름으로 프로그램 카운터(Program Counter)라고 하며, 줄여서 PC라고 함
   - jal 명령은 프로시저에서 복귀할 때 다음 명령어부터 실행하도록 PC + 4를 레지스터 $ra에 저장
