-----
### 메모리 계층 구조
-----
1. 프로그램이 동작하는 방법에는 지역성의 원리(Principle of Locality)이 똑같이 적용
   - 프로그램은 어떤 특정 시간에는 주소 공간 내 비교적 작은 부분만 접근한다는 것이 지역성의 원칙

2. 지역성
   - 시간적 지역성(Temporal Locality) : 어떤 데이터가 참조되면 곧바로 다시 참조될 가능성이 높다는 원칙으로, 한 번 참조된 항목은 곧바로 다시 참조되는 경향이 있음
   - 공간적 지역성(Spatial Locality) : 하나의 데이터가 참조되면, 그 주위의 데이터가 참조될 가능성이 높다는 원칙으로, 어떤 항목이 참조되면 그 근처에 있는 다른 항목들이 곧바로 참조될 가능성이 높음

3. 예) 대부분의 프로그램들이 순환문을 갖고 있고, 순환문은 명령어와 데이터를 반복적으로 접근하므로 상당히 큰 시간적 지역성을 보여줌 : 또 명령어들은 대개 순차적으로 접근되므로 큰 공간적 지역성을 보여줌
   - 데이터 접근에도 자연스럽게 공간적 지역성이 나타나는데, 예를 들어 배열이나 레코드들의 요소들을 순차적으로 접근할 때 자연스럽게 큰 공간적 지역성이 생김

4. 컴퓨터의 메모리를 메모리 계층 구조(Memory Hierarchy)로 구현함으로써 지역성 원칙을 이용할 수 있음
   - 메모리 계층 구조 : 여러 계층의 메모리를 사용하는 구조로, 프로세서로부터 거리가 멀어질수록 메모리의 크기와 접근 시간은 증가하고 비트당 가격은 내려감
   - 메모리 계층구조는 서로 다른 속도와 크기를 갖는 여러 계층의 메모리로 구성되며, 가장 빠른 메모리는 더 느린 메모리보다 비트당 가격이 비싸므로 대개 그 크기가 작음

5. 메모리 계층 구조의 기본 구성
<div align="center">
<img src="https://github.com/user-attachments/assets/cd351b8b-8a8e-403a-b57a-f1e56ada14f6">
</div>

   - 빠른 메모리는 프로세서에 가깝데 두고, 느리고 싼 메모리를 그 아래에 둠
   - 메모리 계층 구조의 목적은 사용자에게 가장 빠른 메모리 접근 속도를 제공하면서, 동시에 가장 싼 메모리만큼의 용량을 제공하는 것

6. 데이터도 이와 유사한 계층 구조를 가짐
   - 프로세서에 가까운 계층은 먼 게층의 부분집합이고, 가장 낮은 계층은 모든 데이터가 다 저장되어 있음
   - 즉, 프로세서에서 멀어질수록 그 계층에 접근하는 데 시간이 오래 걸림

7. 메모리 계층 구조는 여러 계층으로 구성되지만, 데이터는 인접한 두 계층 사이에서만 한 번에 복사가 됨
   - 여기에는 계층을 2개로 한정해서 설명
   - 상위 계층(즉, 프로세서에 가까운 계층)은 더 비싼 기술을 사용하므로 하위 계층보다 작으며 빠름
<div align="center">
<img src="https://github.com/user-attachments/assets/b2b328c2-38af-4ad1-95e4-f0dd111b7583">
</div>

   - 두 계층 간 정보 전송의 최소 단위를 블록(Block) 또는 라인(Line)이라 부름
     + 블록(또는 라인) : 캐시에 있을 수도 있고, 없을 수도 있는 정보의 최소 단위

8. 프로세서가 요구한 데이터가 상위 계층에 어떤 블록에 있을 때 이를 적중(Hit)라고 부르며, 상위 계층에서 찾을 수 없다면 이를 실패(Miss)라고 부름
   - 실패의 경우에는 필요한 데이터릂 포함하는 블록을 찾기 위해 하위 계층 메모리를 접근하게 됨

9. 적중률(Hit Rate, Hit Ratio)은 메모리 계층 구조의 특정 계층에서 찾을 수 있는 메모리 접근의 비율을 의미
    - 즉, 메모리 접근 중 상위 계층에서 찾을 수 있는 것의 비율로서, 메모리 계층의 성능을 평가하는 척도로 이용
    - 실패율(Miss Rate, 1 - 적중률)은 메모리 접근 중 상위 계층에서 찾을 수 없는 메모리 접근의 비율을 말함

10. 메모리 계층 구조를 만든 가장 큰 이유는 성능 향상이므로 적중과 실패의 처리 속도가 매우 중요함
    - 적중 시간(Hit Time)은 메모리 계층 구조의 상위 계층을 접근하는 데 걸리는 시간이며, 이 시간에는 접근이 적중인지 실패인지 결정하는 데 필요한 시간이 포함
      + 적중 시간 : 메모리 계층 구조의 한 계층을 접근하는 데 필요한 시간으로, 접근이 적중인지 실패인지 결정하는데 필요한 시간
    - 실패 손실(Miss Penalty)은 하위 계층에서 해당 블록을 가져와서 상위 계층 블록과 교체하는 시간에다 그 블록을 프로세서에 보내는 데 걸리는 시간
      + 실패 손실 : 하위 계층에서 상위 계층으로 블록을 인출하는 데 걸리는 시간으로, 하위 계층 블록에 접근하고, 하위 계층에서 상위 계층으로 전달하여 실패가 발생한 계층에 넣은 뒤, 요청한 장치로 블록을 넘겨주는 시간을 포함
    - 상위 계층은 작고 빠른 메모리를 사용하여 만들어졌기 때문에 적중 시간은 다음 게층을 접근하는 시간보다 훨씬 적게 걸리며, 실패 손실의 대부분은 다음 계층 접근 시간

11. 메모리 시스템 구축에 사용되는 개념은 운영체제가 메모리와 입출력을 어떻게 관리하는지, 컴파일러가 어떻게 코드를 생성하는지, 응용 프로그램이 어떻게 컴퓨터를 이용하는지 등 컴퓨터의 다른 많은 분야에 영향을 미침
    - 물론, 모든 프로그램이 메모리 접근에 많은 시간을 쓰므로 메모리 시스템은 성능을 결정하는 중요 요소
    - 메모리 계층 구조를 써서 좋은 성능을 얻고 있으므로 좋은 성능을 위해 계층적으로 구성해야 함

12. 정리
    - 프로그램은 최근에 접근했던 데이터들을 다시 사용하려는 경향, 즉 시간적 지역성과 최근에 접근했던 데이터에 대해 인접해 있는 데이터들을 접근하려는 경향, 즉 공간적 지역성을 보임
    - 메모리 계층 구조는 최근에 접근했던 데이터들을 프로세서 가까이 적재함으로써 시간적 지역성을 이용
    - 또한 데이터뿐만 아니라 이와 인접한 다량의 데이터들로 이루어진 블록을 메모리 상위 계층으로 옮김으로써 공간적 지역성을 이용
    - 메모리 게층은 작고 빠른 메모리를 프로세서 가까이 두며, 최상위 계층에는 적중되는 접근은 매우 빠르게 처리 가능하며, 실패된 접근은 느린 하위 계층으로 내려가서 수행됨
    - 적중률이 충분히 크면, 메모리 계층의 접근 속도는 최상위 계층(가장 빠른)과 비슷하고, 크기는 최하위 계층(가장 큰) 메모리와 같아짐
    - 대부분의 시스템에서 메모리는 계층적이며, 즉, 계층 i + 1에 존재하지 않는 데이터는 계층 i에 존재할 수 없음
<div align="center">
<img src="https://github.com/user-attachments/assets/bbe19d07-176f-43e9-9325-dca30acf4656">
</div>
