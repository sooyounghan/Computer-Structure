-----
### 교체할 블록의 선택
-----
1. 직접 사상 캐시에서 실패가 발생되면 요구된 블록은 딱 한 곳으로만 갈 수 있으므로, 그 자리를 차지했던 블록을 교체하면 됨
2. 하지만 연관 방식의 캐시에서는 요구된 블록을 어디에 넣을지 선택하여야 하며, 이는 교체할 블록을 선택하는 것과 동일
   - 완전 연관 캐시에서는 모든 블록이 교체 후보가 됨
   - 집합 연관 캐시의 경우 선정된 집합 내 블록 중에서 골라야 함

3. 가장 널리 사용되는 방식은 이전에 사용했던 LRU(Least Recently Used, 가장 오랫동안 사용되지 않은 블록을 교체하는 방법) 방식
   - LRU 방식에서 교체되는 블록은 가장 오랫동안 사용되지 않은 것이므로, 앞의 예제에서는 블록 6 대신 0이 교체
   - LRU 교체는 집합의 어떤 원소가 다른 원소에 비해 상대적으로 언제 사용되었는지를 추적함으로써 구현 가능
     + 2-way 집합 연관 캐시에서는 각 집합 마다 한 비트를 두고 두 원소가 참조될 때마다 그 원소 번호를 비트 값으로 하면 두 원소의 상대적 사용 시기를 알 수 있지만, 연관 정도가 더 커지면 LRU를 구현하기 힘들어짐

4. 예) 태그의 크기 대 집합의 연관 정도
   - 연관 정도를 늘리면 비교기가 더 많아야 하고, 캐시 블록 하나당 태그 비트도 늘어야 함
   - 블록이 4096개, 블록 크기가 4워드, 메모리 주소가 32비트인 캐시를 직접 사상 / 2-way 집합 연관 / 4-way 집합 연관, 완전 연관 방식으로 구성했을 때 캐시의 전체 집합수와 전체 태그 비트 수
   - 한 블록에는 16(=$2^{4}$)바이트가 있으므로, 32비트 중 32 - 4 = 28비트가 인덱스와 태그로 사용
     + 직접 사상 캐시에서는 블록의 개수와 집합의 개수가 같으므로 $log_{2} (4096)$ = 12비트가 인덱스로 사용되므로, 태그 비트는 모두 (28 - 12) X 4096 - 16 X 4096 = 66 K 비트
   - 연관 정도를 높일 때마다 집합의 수는 절반씩 줄어들게 되므로, 캐시를 인덱스하는 데 필요한 비트 수는 하나씩 감소하고 태그에 필요한 비트는 하나씩 증가
     + 따라서 2-way 집합 연관 캐시 집합은 2048개이고, 전체 태그 비트 수는 (28 - 11) X 2 X 2048 = 70 K 비트가 됨
     + 4-way 집합 연관 캐시는 집합이 1024개이고, 전체 태그 비트 수는 (28 - 10) X 4 X 1024 = 74 K 비트가 됨
     + 완전 연관 캐시의 경우 4096 블록 크기의 집합 하나만 존재하므로 태그는 28비트이며, 전체 태그 비트는 28 X 4096 X 1 = 115 K 비트가 됨
