-----
### 요약
-----
1. 가상 메모리는 메인 메모리와 2차 메모리 사이 캐시 역할을 담당하는 메모리 계층을 나타내는 이름
   - 가상 메모리는 프로그램이 메인 메모리 한계 이상으로 주소 공간을 확장시킬 수 있게 해줌
   - 더 중요한 것은 동시에 활성화된 다수의 프로세스들이 서로 보호된 상태에서 메인 메모리를 공유할 수 있도록 해줌

2. 페이지 부재의 높은 비용 때문에 메인 메모리와 디스크 사이 메모리 계층 구조를 관리하는 것은 쉽지 않은데, 실패율을 줄이기 위한 여러 기법들이 사용
   - 공간적 지역성을 이용해 실패율을 줄이기 위해 페이지를 크게 만듬
   - 페이지 테이블로 구현된 가상 주소와 실제 주소 사이 사상을 완전 연관 방식으로 구현하여 가상 페이지를 메인 메모리 내 어느 곳에나 넣을 수 있게 함
   - 운영체제가 교체할 페이지를 선정하기 위해 LRU나 참조 비트 같은 기술을 사용

3. 2차 메모리에 쓰는 데는 시간이 많이 걸림
   - 그래서 가상 메모리는 나중 쓰기 기법을 사용하며, 변화되지 않은 페이지를 디스크에 저장하는 것을 피하기 위해 페이지 변화 여부를 갱신 비트로 표시

4. 가상 메모리 시스템은 프로그램에 의해 사용되는 가상 주소를 메모리 접근에 사용되는 실제 주소 공간으로 주소 변환
   - 이 주소 변환은 메인 메모리의 보호된 공유를 가능하게 하고, 메모리 할당의 단순화 같은 여러 가지 추가적인 이득을 제공
   - 프로세스들의 상호간 보호를 보장하기 위해서는 운영체제만이 주소 변환을 바꿀 수 있어야 함
   - 이는 사용자 프로그램이 페이지 테이블을 변경하지 못하게 함으로써 구현할 수 있으며, 프로세스들 사이 통제된 페이지 공유는 사용자 프로그램이 페이지에 읽기와 쓰기 접근 권한을 갖고 있는지 표시하는 페이지 테이블의 접근 비트와 운영체제의 도움으로 구현할 수 있음

5. 프로세서가 주소 변환을 할 때마다 메모리 내 페이지 테이블에 접근해야 한다면, 가상 메모리 대가가 너무 커지며, 캐시도 별 도움이 안 됨
   - 대신 TLB가 페이지 테이블의 캐시 역할을 하며, 가상 주소는 TLB 내 변환을 이용해 실제 주소로 변환

6. 캐시, 가상 메모리, TLB 모두 공통되는 원칙과 정책에 의존

7. 가상 메모리가 작은 메모리를 큰 메모리처럼 동작할 수 있도록 개발되었음에도 불구하고, 어떤 프로그램이 실제 메모리보다 더 많이 가상 메모리를 접근하게 되면 디스크와 메모리 성능 차이 때문에 속도가 매우 느려지게 됨
   - 이와 같은 프로그램은 메모리와 디스크 사이에서 끊임없이 페이지 교환이 일어나는 스레싱(Thrashing)이 발생하게 됨
     + 스레싱은 자주 발생하지는 않지만, 일단 발생하면 손실이 매우 큼
     + 이를 해결하는 가장 쉬운 방법은 메모리가 더 큰 컴퓨터에서 실행하든지 아니면 컴퓨터에 메모리를 추가하는 것
     + 더 복잡한 방법은 알고리즘과 자료구조를 다시 점검하여 지역성을 바꿈으로써 프로그램이 동시에 사용하는 페이지의 수를 줄이는 것
     + 이처럼 자주 사용되는 페이지들의 집합을 비공식적으로 워킹셋(Working Set)이라고 부름
   - 더 자주 생기는 성능 문제는 TLB 실패 : TLB은 한 번에 겨우 32 ~ 64 페이지 정도만 처리할 수 있으므로 프로세서가 직접 접근할 수 있는 크기는 64 X 4 KiB = 0.25 MiB 밖에 되지 않으므로 프로그램이 높은 TLB 실패율을 겪는 경우가 흔함
     + 예를 들어 기수 정렬에서 TLB 실패는 골치 아픈 문제로, 이 문제를 완화하기 위해 대부분 컴퓨터 구조는 가변 페이지 크기를 지원
     + 예를 들어 MIPS 하드웨어는 표준 4 KiB 페이지 외에 16 / 64 / 256 KiB, 1 / 4 / 16 / 64 / 256 MiB 페이지를 지원
     + 프로그램이 더 큰 페이지를 사용하면 TLB 실패 없이 직접 접근할 수 있는 메모리가 더 커짐
   - 하지만 실제로 어려운 문제는 프로그램이 이와 같이 더 큰 페이지 크기를 선택하는 것을 운영체제가 허용하는 것
     + TLB 실패를 줄이는 더 복잡한 해결책은 결국 알고리즘과 자료구조를 다시 점검해서 페이지 워킹셋을 줄이는 것
     + 메모리 접근이 성능과 TLB 실패율에 미치는 영향이 크기 때문에, 워킹셋이 큰 프로그램들은 워킹셋이 작아지도록 재설계되기도 함
