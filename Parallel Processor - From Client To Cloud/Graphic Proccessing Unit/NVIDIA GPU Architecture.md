-----
### NVIDIA GPU 구조
-----
1. GPU 구조를 대표하는 예로 NVIDIA 시스템을 사용
2. 벡터 구조처럼 GPU는 데이터 수준 병렬 문제를 잘 처리
   - 수집-분산 방식의 데이터 이동을 지원하는데 GPU 프로세서가 벡터 프로세서보다 더 많은 레지스터를 가지고 있음
   - 대부분 벡터 프로세서와 달리 GPU는 메모리 지연을 감추기 위해 한 멀티스레드 SIMD 프로세서 내 하드웨어 멀티스레딩도 사용
  
3. 멀티스레딩 SIMD 프로세서는 벡터 프로세서와 비슷
   - 그러나 깊게 파이프라이닝되어 있는 기능 유닛을 몇 개 가지고 있는 벡터 프로세서와 달리 GPU는 많은 수의 병렬 기능 유닛을 가지고 있음

4. GPU는 멀티스레드 SIMD 프로세서들을 가지고 있음 : 즉, GPU는 멀티스레드 SIMD들로 구성된 MIMD
   - 멀티스레드 SIMD 프로세서 수가 다른 GPU 모델 간에 투명한 확장성이 유지되도록 스레드 볼록 스케줄러 하드웨어가 스레드 블록을 멀티스레드 SIMD 프로세서에 할당
   - 멀티스레드 SIMD 프로세서의 간략화된 블록 다이어그램
<div align="center">
<img src="https://github.com/user-attachments/assets/24652b33-56da-4d18-b154-9fa7a0375e27">
</div>

   - 하드웨어가 생성하고 관리하며 스케줄링하고 실행하는 객체는 SIMD 명령어들의 스레드
     + 이를 SIMD 스레드라고 부름
     + SIMD 스레드들은 전통적인 스레드의 일종이지만 SIMD 명령어로만 구성되어 있음
     + 이 SIMD 스레드들은 독자적인 프로그램 카운터를 가지고 있으며, 멀티스레드 SIMD 프로세서에 수행
     + SIMD 스레드 스케줄러는 어떤 SIMD 스레드가 실행할 준비가 되어 있는지를 알려주는 제어기를 포함하고 있으며, 실행할 SIMD 스레드를 디스패치 유닛에 전달하여 멀티스레드 SIMD 프로세서에서 실행되도록 함
   - SIMD 명령어로 구성된 스레드를 스케줄링한다는 점을 제외하면 전통적인 멀티스레드 프로세서의 하드웨어 스레드 스케줄과 동일
   - 그러므로 GPU 하드웨어는 두 단계의 하드웨어 스케줄러를 가짐
     + 스레드 블록을 멀티스레드 SIMD 프로세서에 할당하는 스레드 블록 스케줄러
     + SIMD 프로세서 내에서 SIMD 스레드를 스케줄링하는 SIMD 스레드 스케줄러

5. 이 스레드의 SIMD 명령어는 폭이 32이어서 SIMD 명령어 각 스레드는 32개의 원소에 대해 계산을 수행
   - 스레드가 SIMD 명령어로 구성돠어 있으므로 SIMD 프로세서는 연산을 수행하기 위해 병렬 기능 유닛을 가져야 함
   - 이를 SIMD 레인이라 함

6. 폭이 32인 SIMD 명령어는 16개의 SIMD 레인에 매핑되고, SIMD 스레드의 각 SIMD 명령어는 두 클럭 사이클에 걸쳐서 수행
   - SIMD 명령어의 각 스레드는 락-스텝(Lock-Step)이라는 방식으로 진행
   - SIMD 프로세서를 벡터 프로세서에 비유하면 레인이 16개, 벡터 길이는 32인 것에 해당
   - 레인의 수는 많은데 벡터의 길은 짧은 특성 때문에 벡터 프로세서라는 용어 대신 SIMD라는 용어를 사용
   - 정의상 SIMD 명령어들의 스레드는 독립적이므로 SIMD 스레드 스케줄러라는 실행 준비가 된 SIMD 명령어 스레드 중 아무것이나 선택할 수 있어서, 꼭 같은 스레드 내 다음 SIMD 명령어를 순차적으로 실행해야 되는 것은 아님
   - 이런 메모리 원소들을 저장하기 위해 SIMD 프로세서는 무려 32,768개의 32비트 레지스터를 가지고 있음
     + 벡터 프로세서에서 레지스터들이 논리적으로 벡터 레인에 나누어지듯, 여기서는 SIMD 레인에 나누어짐
     + 각 SIMD 스레드가 사용할 수 있는 레지스터는 64개 이내로 제한되어 있으므로, SIMD 스레드 하나가 최대 64개의 벡터 레지스터를 갖고, 각 벡터 레지스터는 32개의 원소를 가지며, 각 원소는 32비트 폭을 갖는 것으로 생각할 수 있음
   - SIMD 프로세서엔느 16개의 SIMD 레인이 있고, 각 레인에는 2048개의 레지스터가 있음
   - CUDA 스레드는 각 벡터 레지스터에서 원소를 하나씩 꺼내며, CUDA 스레드는 SIMD 명령어의 스레드를 수직으로 자른 것과 같아서, 한 SIMD 레인이 수행하는 원소 하나에 해당
   - CUDA 스레드는 POSIX 스레드와 전혀 다르며, CUDA 스레드 내에서 아무 시스템 호출이나 할 수 있는 것은 아니며, 마음대로 동기화도 불가
